#!/bin/sh
# *************************************************************************** # 
#                                                                             #
#          Firewall test script based on prescribed network layout            # 
#                                                                             #
#        Release version 1.0 by Terence Broadbent BSc Cyber Security          #
#                                                                             #
#                                                                             #
# *************************************************************************** # 
 
# *************************************************************************** # 
# AUTHOR: Terence Broadbent                                                   # 
# CONTRACT: SME                                                               # 
# Version: 1.0                                                                # 
# Details: Define any global variables used throughout the bash script.       # 
# Modified: N/A                                                               #
# *************************************************************************** # 

NET="ens33"          # IMPORTANT! CHANGE THIS TO MATCH YOUR NETWORK. 
DOMAIN="1"           # IMPORTANT! SET 1 FOR EXTERNAL AND 2 INTERNAL TEST.
IP="xxx.xxx.x.xx"    # IMPORTANT! CHANGE THIS TO MATCH THE FIREWALL IP. 
LOGFILE="./Log2.txt" # The default log filename.
SEC="10"             # Increase this value to prolong the DoS flooding period. 
 
# *************************************************************************** # 
# AUTHOR: Terence Broadbent                                                   # 
# CONTRACT: SME                                                               # 
# Version: 1.0                                                                # 
# Details: Create log system & check that bash script has root privileges.    # 
# Modified: N/A                                                               # 
# *************************************************************************** # 
 
echolog() ( echo $1 echo $1 >> $LOGFILE
if [ $USER != "root" ]    
   then echo "Please run this bash script as root..."
    exit 0
else
    echolog "\n\tLINUX FIREWALL EXT/INT PENETRATION TEST LOG - VERSION 1.0\n" 
fi 
 
# *************************************************************************** # 
# AUTHOR: Terence Broadbent                                                   #  
# CONTRACT: SME                                                               # 
# Version: 1.0                                                                # 
# Details: Comprehensive penetration test for newly installed firewall.       # 
# Modified: N/A                                                               #
# *************************************************************************** # 
 
echolog "[1]. Starting the Penetration test...\n" 
 
#EXT
if [ $DOMAIN="1" ];
    then  telnet $IP 80 > ./Report1.txt 2>&1 | tee -a $LOGFILE
    echolog "\t- Penetration test one completed...\n" 
fi 
 
#EXT
if [ $DOMAIN="1" ];
   then  hping3 -V -c $SEC -S --faster --rand-source -1 $IP > ./Report2.txt 2>&1 | tee -a $LOGFILE 
   echolog "\t- Penetration test two completed...\n" 
fi 
 
#INT
if [ $DOMAIN="2" ];
    then  curl -Is http://www.facebook.com | head -1 > ./Report3.txt 2>&1 | tee -a $LOGFILE 
    echolog "\t- Penetration test three completed...\n" 
fi 
 
#INT
if [ $DOMAIN="2" ];
   then  ping -v -c 10 127.0.0.1 > ./Report4.txt 2>&1 | tee -a $LOGFILE 
   echolog "\t- Penetration test four completed...\n" 
fi 
 
#INT
if [ $DOMAIN="2" ];
   then  ssh -v 127.0.0.1 22 > ./Report5.txt 2>&1 | tee -a $LOGFILE
   echolog "\t- Penetration test five completed...\n" 
fi 
 
#EXT
if [ $DOMAIN="1" ];
    then  nc -zv $IP 3333 > ./Report6.txt 2>&1 | tee -a $LOGFILE 
    echolog "\t- Penetration test six completed...\n" 
fi 
 
#EXT
if [ $DOMAIN="1" ];
    then  nmap -v -e $NET -S 169.254.0.0 $IP -Pn > ./Report7.txt 2>&1 | tee -a $LOGFILE
    echolog "\t- Penetration test seven completed...\n" 
fi 
 
#EXT
if [ $DOMAIN="1" ];
   then  hping3 -V -c $SEC -1 -C 17 $IP > ./Report8.txt 2>&1 | tee -a $LOGFILE
   echolog "\t- Penetration test eight completed...\n" 
fi 
 
#EXT
if [ $DOMAIN="1" ];
   then  hping3 -V -c $SEC -p 80 -s 5050 -A $IP > ./Report9.txt 2>&1 | tee -a $LOGFILE
   echolog "\t- Penetration test nine completed...\n" 
fi 
 
#EXT
if [ $DOMAIN="1" ];
   then  hping3 -V -c $SEC -p 80 -s 5050 -Y $IP > ./Report10.txt 2>&1 | tee -a $LOGFILE
   echolog "\t- Penetration test ten completed...\n" 
fi 
 
#EXT
if [ $DOMAIN="1" ];
    then  hping3 -V -c 10 -S --faster --rand-source $IP > ./Report11.txt 2>&1 | tee -a $LOGFILE
    echolog "\t- Penetration test eleven completed...\n" 
fi 
 
#EXT
if [ $DOMAIN="1" ];
    then  nmap -v $IP -p 25 -Pn > ./Report12.txt 2>&1 | tee -a $LOGFILE
    nmap -v $IP -p 110 -Pn >> ./Report12.txt 2>&1 | tee -a $LOGFILE 
    nmap -v $IP -p 143 -Pn >> ./Report12.txt 2>&1 | tee -a $LOGFILE 
    nmap -v $IP -p 465 -Pn >> ./Report12.txt 2>&1 | tee -a $LOGFILE
    nmap -v $IP -p 993 -Pn >> ./Report12.txt 2>&1 | tee -a $LOGFILE 
    nmap -v $IP -p 995 -Pn >> ./Report12.txt 2>&1 | tee -a $LOGFILE 
   echolog "\t- Penetration test twelve completed...\n" 
fi 
 
#INT
if [ $DOMAIN="2" ];
    then  nmap -v lo -p 3306 -Pn > ./Report13.txt 2>&1 | tee -a $LOGFILE
    echolog "\t- Penetration test thirteen completed...\n" 
fi 
 
#EXT
if [ $DOMAIN="1" ];
    then  nmap -v -e $NET -p 7001 -S 192.168.50.21 $IP -Pn > ./Report14.txt 2>&1 | tee -a $LOGFILE
    echolog "\t- Penetration test fourteen completed...\n" 
fi 
 
#INT 
if [ $DOMAIN="2" ];
   then  grep -i "UFW" /var/log/syslog > ./Report15.txt 2>&1 | tee -a $LOGFILE 
   echolog "\t- Penetration test fifthteen completed...\n" 
fi 
 
#EXT
if [ $DOMAIN="1" ];
    then  mz -v -Q $NET -A rand -B $IP -t dns "q=pentesting.blog" -c $SEC > ./Report16.txt 2>&1 | tee -a $LOGFILE 
    echolog "\t- Penetration test sixteen completed...\n" 
fi 
 
#EXT
if [ $DOMAIN="1" ];
    then  python hulk.py -site $IP:80 & sleep 10 >> ./Report17.txt 2>&1 | tee -a $LOGFILE
    echolog "\t- Penetration test seventeen completed...\n" 
fi 
 
#EXT
if [ $DOMAIN="1" ];
   then  hping3 -V -c $SEC --icmp $IP > ./Report18.txt 2>&1 | tee -a $LOGFILE 
    echolog "\t- Penetration test eighteen completed...\n" 
fi 
 
#EXT
if [ $DOMAIN="1" ];
   then  nmap -v -e $NET -sX $IP -Pn > ./Report19.txt 2>&1 | tee -a $LOGFILE
   echolog "\t- Penetration test nineteen completed...\n" 
fi 
 
#EXT
if [ $DOMAIN="1" ];
   then  sh -c "ping -c $SEC -s 1000 $IP > ./Report20.txt 2>&1 | tee -a $LOGFILE"
   fragroute $IP & sleep $SEC > ./Report20.txt 2>&1 | tee -a $LOGFILE
  echolog "\t- Penetration test twenty completed...\n" 
fi 
 
#EXT
if [ $DOMAIN="1" ];
    then  hping3 -V -d 120 -c $SEC -S -w 64 -p 445 -s 455 --faster --rand-source $IP >> ./Report21.txt 2>&1 | tee -a $LOGFILE 
    echolog "\t- Penetration test twentyone completed...\n" 
fi 
 
echolog "\nYou have successfully performed the penetration test....\n" 
#EOF